-- CHALLENGE 1

SELECT a.au_fname, a.au_lname, a.au_id, t.title_id, p.pub_name
from authors a
left join titleauthor e
on a.au_id=e.au_id
left join titles t 
on t.title_id=e.title_id
left join publishers p 
on p.pub_id=t.pub_id
WHERE TITLE IS NOT NULL

-- left join me deja la tabla a la izquierda y con el ON comparo cada 
-- recurso de la izq con la tabla que por descarte queda en la derecha
-- el SELECT se ejecuta de Ãºltimo. Los joins van primero y luego
-- se pasa por el select para validar eso que se "selecciona"

-- CHALLENGE 2

SELECT a.au_fname as "FIRST NAME", a.au_lname as "LAST NAME", a.au_id as "AUTHOR ID", 
p.pub_name as "PUBLISHER", count(t.title_id) as "TITLE COUNT"
from authors a
left join titleauthor e
on a.au_id=e.au_id
left join titles t 
on t.title_id=e.title_id
left join publishers p 
on p.pub_id=t.pub_id
group by a.au_id
order by "TITLE COUNT" DESC

-- CHALLENGE 3 

SELECT a.au_fname as "FIRST NAME", a.au_lname as "LAST NAME", a.au_id as "AUTHOR ID", 
count(t.title_id) as "TOTAL"
from authors a
left join titleauthor e
on a.au_id=e.au_id
left join titles t 
on t.title_id=e.title_id
left join publishers p 
on p.pub_id=t.pub_id
group by a.au_id
order by total desc
limit 3

-- CHALLENGE 4

SELECT a.au_fname as "FIRST NAME", a.au_lname as "LAST NAME", a.au_id as "AUTHOR ID", 
count(t.title_id) as "TOTAL"
from authors a
left join titleauthor e
on a.au_id=e.au_id
left join titles t 
on t.title_id=e.title_id
left join publishers p 
on p.pub_id=t.pub_id
group by a.au_id
order by total desc